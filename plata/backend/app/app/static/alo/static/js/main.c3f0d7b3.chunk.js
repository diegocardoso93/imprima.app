(this.webpackJsonpwasp=this.webpackJsonpwasp||[]).push([[0],{106:function(e,t,c){},108:function(e,t,c){},110:function(e,t,c){},209:function(e,t,c){"use strict";c.r(t);var n=c(1),i=c.n(n),a=c(47),o=c.n(a),s=(c(89),c(84)),r=c(3),l=c(2),d="https://imprima.app/api",j="".concat(d,"/product/?kind_id={kindId}"),u="".concat(d,"/product/{id}"),b="".concat(d,"/merchant/?product_id={id}&cep={cep}"),h="".concat(d,"/category"),O="".concat(d,"/product/?category_id={categoryId}&type_id={typeId}"),m="".concat(d,"/merchant_type_attribute/?product_id={productId}&merchant_id={merchantId}"),p="".concat(d,"/checkout/preference"),v="".concat(d,"/image"),x=(c(90),c(0));function f(e){var t=e.children,c=e.stackclose;return Object(x.jsxs)("div",{className:"header",children:[t,Object(x.jsx)("div",{className:"close",onClick:function(){history.go(c),parent.postMessage({active:!1},"*")},children:"\xd7"})]})}c(92);function g(e){var t=e.children;return Object(x.jsx)("div",{className:"body",children:t})}c(93);function N(e){var t=e.size;return Object(x.jsxs)("div",{className:"lds-ring ".concat(t),children:[Object(x.jsx)("div",{}),Object(x.jsx)("div",{}),Object(x.jsx)("div",{}),Object(x.jsx)("div",{})]})}c(94);function y(e){var t=e.size;return Object(x.jsx)("svg",{width:"23",height:"39",viewBox:"0 0 23 39",style:{transform:"scale(".concat("small"===t?"1":"0.8",")"),fill:"#444"},children:Object(x.jsx)("path",{className:"slideshow-arrow",d:"M857.005,231.479L858.5,230l18.124,18-18.127,18-1.49-1.48L873.638,248Z",transform:"translate(-855 -230)"})})}function w(){var e=Object(n.useState)([]),t=Object(l.a)(e,2),c=t[0],i=t[1],a=Object(n.useState)(!1),o=Object(l.a)(a,2),s=o[0],d=o[1],u=Object(r.f)();Object(n.useEffect)((function(){var e=0;return window.onbeforeunload=function(t){0==e&&(b(),e=1)},window.onpopstate=function(e){b()},function(){window.onbeforeunload=function(){},window.onpopstate=function(){}}}),[]);var b=function(){parent.postMessage({active:!1},"*")};return Object(n.useEffect)((function(){d(!0),fetch(j.replace("{kindId}",localStorage.getItem("kindId")||"")).then((function(e){return e.json()})).then((function(e){i(e),d(!1)}))}),[]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(f,{stackclose:-1,children:Object(x.jsxs)("div",{className:"logo",children:[Object(x.jsx)("a",{href:"https://imprima.app",target:"_blank",rel:"noreferrer",className:"logo-link",children:Object(x.jsx)("div",{className:"inner",children:Object(x.jsx)("img",{src:"/img/logo_100.png",alt:""})})}),Object(x.jsx)("h1",{children:"Comprar personalizado"})]})}),Object(x.jsx)(g,{children:s&&Object(x.jsx)("div",{className:"loader-container",children:Object(x.jsx)(N,{size:"large"})})||Object(x.jsx)("div",{className:"page-items",children:Object(x.jsx)("div",{className:"options",children:c.map((function(e){return Object(x.jsxs)("div",{className:"option",onClick:function(){return function(e){u.push("/alo/produto/".concat(e.id).concat(location.search))}(e)},children:[Object(x.jsxs)("div",{className:"left",children:[Object(x.jsx)("img",{src:e.thumb_url,alt:"",className:"image"}),Object(x.jsx)("span",{children:e.name})]}),Object(x.jsx)("span",{className:"select",children:Object(x.jsx)(y,{})})]},e.name)}))})})})]})}var S=c(77),k=c.n(S);function I(){return Object(x.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",children:Object(x.jsxs)("g",{fill:"none",fillRule:"evenodd",children:[Object(x.jsx)("path",{d:"M0 0H16V16H0z",transform:"matrix(1 0 0 -1 0 16)"}),Object(x.jsx)("path",{fill:"#444",fillRule:"nonzero",d:"M7.631 1.333L6.368 0 0 6.667 6.368 13.333 7.631 12.001 3.428 7.6 13.333 7.601 13.333 5.743 3.418 5.742z",transform:"matrix(1 0 0 -1 0 16) translate(1.333 1.333)"})]})})}c(106),c(107);function _(){var e=Object(r.g)().id,t=Object(n.useState)(!1),c=Object(l.a)(t,2),i=c[0],a=c[1],o=Object(n.useState)(!1),s=Object(l.a)(o,2),d=s[0],j=s[1],m=Object(n.useState)(null),p=Object(l.a)(m,2),w=p[0],S=p[1],_=Object(n.useState)(null),C=Object(l.a)(_,2),z=C[0],q=C[1],F=Object(n.useState)(null),M=Object(l.a)(F,2),B=M[0],P=M[1],R=Object(n.useState)({loading:!1,show:!1}),T=Object(l.a)(R,2),E=T[0],J=T[1],L=Object(n.useState)(!0),D=Object(l.a)(L,2),$=D[0],A=D[1],V=Object(n.useRef)(),W=Object(n.useState)(),H=Object(l.a)(W,2),U=H[0],K=H[1],Q=Object(n.useState)(!1),Z=Object(l.a)(Q,2),G=Z[0],X=Z[1],Y=Object(r.f)(),ee=Object(n.useState)({result:null,filename:null,filetype:null,src:null,error:null}),te=Object(l.a)(ee,2),ce=te[0],ne=te[1],ie=Object(n.useState)(!1),ae=Object(l.a)(ie,2),oe=ae[0],se=ae[1],re=Object(n.useState)(!1),le=Object(l.a)(re,2),de=(le[0],le[1]);function je(){j(!0);var t=V.current.value;fetch(b.replace("{id}",e).replace("{cep}",t)).then((function(e){return e.json()})).then((function(e){j(!1),S(e.merchants),localStorage.setItem("address",JSON.stringify(e.address))})).catch((function(e){return j(!1)}))}function ue(){E.show?J({loading:!1,show:!1}):(J({loading:!0,show:!0}),fetch(h,{mode:"cors"}).then((function(e){return e.json()})).then((function(e){J({loading:!1,show:!0}),q(e)})).catch((function(e){return J({loading:!1,show:!1})})))}return Object(n.useEffect)((function(){a(!0),fetch(u.replace("{id}",e)).then((function(e){return e.json()})).then((function(e){a(!1),K(e);var t=JSON.parse(localStorage.getItem("address"));(null===t||void 0===t?void 0:t.zip)&&(V.current.value=t.zip,je())})).catch((function(e){return a(!1)}))}),[]),Object(n.useEffect)((function(){if(oe){document.querySelector(".dropzone-instructions--main").innerText="Para enviar a imagem, clique ou arraste aqui.";var e=document.querySelectorAll(".dropzone-instructions--sub");e[0].innerText="Arquivos aceitos: .jpeg, .jpg, .png",e[1].innerText="Tamanho m\xe1ximo: 10MB"}}),[oe]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(f,{stackclose:-2,children:Object(x.jsxs)("div",{className:"title",children:[Object(x.jsx)("div",{onClick:function(){return Y.goBack()},children:Object(x.jsx)(I,{})}),Object(x.jsx)("div",{children:null===U||void 0===U?void 0:U.name})]})}),Object(x.jsx)(g,{children:i&&Object(x.jsx)("div",{className:"loader-container",children:Object(x.jsx)(N,{size:"large"})})||Object(x.jsxs)("div",{className:"page-detail",children:[Object(x.jsxs)("div",{className:"item ".concat(!$&&"hidden"),children:[oe&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(k.a,{onChange:function(e){console.log("onDrop",e),ne(e)},value:ce,maxFileSize:10485760,cropperOptions:{guides:!0,viewMode:2,autoCropArea:1,movable:!1,rotatable:!1,scalable:!1,zoomable:!1,dragMode:"none"}}),Object(x.jsxs)("div",{className:"btn-drop-container",children:[Object(x.jsx)("button",{className:"btn-drop",onClick:function(){se(!1),ue()},children:"\u2716 cancelar"}),Object(x.jsx)("button",{className:"btn-drop confirm",onClick:function(){return function(){var e=ce.filename,t=ce.filetype,c=ce.result;console.log("image",{filename:e,filetype:t,result:c}),de(!0),fetch(v,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({filename:e,filetype:t,result:c})}).then((function(e){return e.json()})).then((function(e){console.log(e),de(!1)})).catch((function(e){return de(!1)}))}()},children:"\u2714 enviar"})]})]})||Object(x.jsx)("img",{src:null===U||void 0===U?void 0:U.url,alt:null===U||void 0===U?void 0:U.name}),Object(x.jsxs)("div",{className:"hcategory",children:[Object(x.jsxs)("div",{className:"switch-container",children:["trocar estampa",Object(x.jsxs)("label",{className:"switch",children:[Object(x.jsx)("input",{type:"checkbox",onChange:ue}),Object(x.jsx)("span",{className:"slider round"})]})]}),Object(x.jsx)("div",{className:"category-container",children:E.show&&(E.loading&&Object(x.jsx)(N,{})||Object(x.jsxs)("select",{onChange:function(e){var t=e.target.value;if(console.log("category",t),"enviar"===t)return se(!0),void J({loading:!1,show:!1});se(!1),X(!0),fetch(O.replace("{categoryId}",t).replace("{typeId}",U.type_id),{mode:"cors"}).then((function(e){return e.json()})).then((function(e){P(e),X(!1)})).catch((function(e){return X(!1)}))},children:[Object(x.jsx)("option",{children:"selecione"}),Object(x.jsx)("option",{value:"enviar",children:"enviar foto"}),null===z||void 0===z?void 0:z.map((function(e){return Object(x.jsx)("option",{value:e.id,children:e.name},e.id)}))]}))})]}),Object(x.jsx)("div",{className:"image-list",children:E.show&&(G&&Object(x.jsx)(N,{})||B&&B.map((function(e){return Object(x.jsx)("img",{src:e.thumb_url,onClick:function(){K(e)}},e.id)})))})]}),Object(x.jsxs)("div",{className:"stores",children:[Object(x.jsxs)("div",{className:"find",children:[Object(x.jsx)("button",{onClick:function(){return A(!$)},children:Object(x.jsx)("span",{className:"".concat($?"top":"bottom"),children:Object(x.jsx)("svg",{focusable:"false",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:Object(x.jsx)("path",{d:"M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"})})})}),Object(x.jsx)("input",{ref:V,onKeyUp:function(e){"Enter"===e.key&&je()},placeholder:"Digite seu CEP",onFocus:function(){return window.innerWidth<600&&A(!1)}}),Object(x.jsx)("button",{onClick:function(){return je()},children:d&&Object(x.jsx)(N,{})||"\ud83d\udd0d"})]}),Object(x.jsx)("div",{className:"list",children:w&&((null===w||void 0===w?void 0:w.length)&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"item",children:[Object(x.jsx)("div",{className:"i1 b",children:"Fornecedor"}),Object(x.jsx)("div",{className:"i2 b",children:"Pre\xe7o"}),Object(x.jsx)("div",{className:"i3 b",children:"Frete"}),Object(x.jsx)("span",{className:"i5",children:"\xa0"})]}),w.map((function(e){return Object(x.jsxs)("div",{className:"item",children:[Object(x.jsxs)("div",{className:"i1",children:[e.name,Object(x.jsx)("br",{}),Object(x.jsxs)("span",{className:"small",children:[e.city," - ",e.uf]})]}),Object(x.jsxs)("div",{className:"i2",children:[Object(x.jsx)("div",{className:"small",children:"a partir de"}),"R$",e.price]}),Object(x.jsx)("div",{className:"i3 ".concat("gr\xe1tis"===e.delivery?"green":"red"),children:e.delivery}),Object(x.jsx)("span",{className:"i5",onClick:function(){return function(e){Y.push("/alo/checkout/".concat(U.id,"/").concat(e.id).concat(location.search))}(e)},children:Object(x.jsx)(y,{size:"small"})})]},e.id)}))]})||Object(x.jsx)("h3",{children:"Nenhum fornecedor na sua localidade."}))})]})]})})]})}function C(e){var t=function(e,t){return localStorage.setItem(e,JSON.stringify(t))},c=e?function(c){return t(e,c)}:function(e,c){return t(e,c)},n=function(e){return JSON.parse(localStorage.getItem(e))};return[e?n(e):function(e){return n(e)},c]}c(108);function z(){var e,t,c,i=Object(r.g)(),a=i.productId,o=i.merchantId,s=Object(r.f)(),d=C("checkout"),j=Object(l.a)(d,2),u=(j[0],j[1]),b=Object(n.useState)(!1),h=Object(l.a)(b,2),O=h[0],p=h[1],v=Object(n.useState)(),y=Object(l.a)(v,2),w=y[0],S=y[1],k=Object(n.useState)(),_=Object(l.a)(k,2),z=_[0],q=_[1],F=Object(n.useState)(),M=Object(l.a)(F,2),B=M[0],P=M[1],R=Object(n.useState)(),T=Object(l.a)(R,2),E=T[0],J=T[1],L=Object(n.useState)(),D=Object(l.a)(L,2),$=D[0],A=D[1],V=Object(n.useState)(),W=Object(l.a)(V,2),H=W[0],U=W[1],K=Object(n.useState)(1),Q=Object(l.a)(K,2),Z=Q[0],G=Q[1],X=Object(n.useState)(0),Y=Object(l.a)(X,2),ee=Y[0],te=Y[1],ce=Object(n.useState)(),ne=Object(l.a)(ce,2),ie=ne[0],ae=ne[1];function oe(e,t){te(t),ae(e*t)}return Object(n.useEffect)((function(){p(!0),fetch(m.replace("{productId}",a).replace("{merchantId}",o)).then((function(e){return e.json()})).then((function(e){var t;S(e.product),J(e.attributes);var c=e.attributes.filter((function(e){return!e.price}));c=(null===(t=c)||void 0===t?void 0:t.length)?c:e.attributes,P(c),q(e.merchant),p(!1)})).catch((function(e){return p(!1)}))}),[]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(f,{stackclose:-3,children:Object(x.jsxs)("div",{className:"title",children:[Object(x.jsx)("div",{onClick:function(){return s.goBack()},children:Object(x.jsx)(I,{})}),Object(x.jsx)("div",{children:null===z||void 0===z?void 0:z.name})]})}),Object(x.jsx)(g,{children:O&&Object(x.jsx)("div",{className:"loader-container",children:Object(x.jsx)(N,{size:"large"})})||Object(x.jsx)(x.Fragment,{children:Object(x.jsxs)("div",{className:"page-checkout",children:[Object(x.jsx)("h5",{children:null===w||void 0===w?void 0:w.name}),Object(x.jsxs)("div",{className:"first",children:[Object(x.jsx)("div",{className:"left-container",children:Object(x.jsx)("img",{src:null===w||void 0===w?void 0:w.url,alt:null===w||void 0===w?void 0:w.name})}),Object(x.jsxs)("div",{className:"right-container",children:[Object(x.jsxs)("div",{className:"attributes-container",children:[B&&B[0].name,Object(x.jsx)("div",{className:"options",children:null===B||void 0===B?void 0:B.map((function(e,t){return Object(x.jsx)("div",{className:"button-check ".concat($===e.id&&"selected"),onClick:function(){A(e.id),e.price?U(e):U(null),oe(Z,e.price)},children:e.value},t)}))})]}),$&&(null===E||void 0===E||null===(e=E.find((function(e){return e.merchant_type_attribute_id===$})))||void 0===e?void 0:e.name)&&Object(x.jsxs)("div",{className:"attributes-container",children:[null===E||void 0===E||null===(t=E.find((function(e){return e.merchant_type_attribute_id===$})))||void 0===t?void 0:t.name,Object(x.jsx)("div",{className:"options",children:null===(c=E.filter((function(e){return e.merchant_type_attribute_id===$})))||void 0===c?void 0:c.map((function(e,t){return Object(x.jsx)("div",{className:"button-check ".concat((null===H||void 0===H?void 0:H.id)===e.id&&"selected"),onClick:function(){oe(Z,e.price),U(e)},children:e.value},t)}))})]}),Object(x.jsxs)("div",{className:"quantity-container",children:[Object(x.jsx)("span",{children:"Quantidade"}),Object(x.jsx)("input",{type:"number",value:Z,onChange:function(e){oe(e.target.value,ee),G(e.target.value)}})]}),Object(x.jsxs)("div",{className:"price-container",children:[Object(x.jsx)("span",{children:"Pre\xe7o final"}),Object(x.jsx)("div",{children:ie&&"R$".concat(ie)||"selecione"})]})]})]}),Object(x.jsx)("div",{className:"next",children:Object(x.jsx)("button",{onClick:function(){ee?(u({attribute:H,product:w,merchant:z,quantity:Z}),s.push("/alo/checkout-info".concat(location.search))):alert("escolha o tamanho e a quantidade")},children:"Continuar"})})]})})})]})}var q=c(50),F=c.n(q),M=c(78),B=c(10),P=(c(110),c(21)),R=P.a().shape({name:P.b().required("Campo obrigat\xf3rio"),address:P.b().required("Campo obrigat\xf3rio"),cellphone:P.b().required("Campo obrigat\xf3rio"),note:P.b()});function T(){var e=C("checkout"),t=Object(l.a)(e,2),c=t[0],i=(t[1],Object(r.f)()),a=Object(n.useState)(),o=Object(l.a)(a,2),s=o[0],d=o[1],j=c.attribute,u=c.merchant,b=c.product,h=c.quantity;function O(e){var t=e.name,c=e.cellphone,n=e.address,i=e.note;d(!0),fetch(p,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({order:{merchant_id:null===u||void 0===u?void 0:u.id,name:t,cellphone:c,address:n,note:i,origin:localStorage.getItem("origin")},orderItem:{product_id:null===b||void 0===b?void 0:b.id,merchant_type_attribute_id:null===j||void 0===j?void 0:j.id,name:m(),description:v(),quantity:h}})}).then((function(e){return e.json()})).then((function(e){console.log(e),e.init_point&&(parent.location.href=e.init_point),d(!1)})).catch((function(e){alert("erro"),d(!1)}))}function m(){return"".concat(h,"x ").concat(null===b||void 0===b?void 0:b.name)}function v(){return"".concat(null===j||void 0===j?void 0:j.type," ").concat(null===j||void 0===j?void 0:j.value," - R$").concat(h*(null===j||void 0===j?void 0:j.price))}return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(f,{stackclose:-4,children:Object(x.jsxs)("div",{className:"title",children:[Object(x.jsx)("div",{onClick:function(){return i.goBack()},children:Object(x.jsx)(I,{})}),Object(x.jsx)("div",{children:"Resumo do pedido"})]})}),Object(x.jsx)(g,{children:Object(x.jsxs)("div",{className:"page-checkout-info",children:[Object(x.jsxs)("div",{className:"product-details",children:[m(),Object(x.jsx)("br",{}),v()]}),Object(x.jsx)("h5",{children:"Vendedor:"}),Object(x.jsxs)("div",{className:"seller",children:[null===u||void 0===u?void 0:u.name," - ",null===u||void 0===u?void 0:u.phone,Object(x.jsx)("br",{}),null===u||void 0===u?void 0:u.address,", ",null===u||void 0===u?void 0:u.address_extra," -"," ",null===u||void 0===u?void 0:u.neighborhood,", ",null===u||void 0===u?void 0:u.city,", ",null===u||void 0===u?void 0:u.uf]}),Object(x.jsx)(B.d,{initialValues:{name:"",address:"",city:"",cellphone:""},onSubmit:function(){var e=Object(M.a)(F.a.mark((function e(t){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,500)}));case 2:O(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),validationSchema:R,children:Object(x.jsxs)(B.c,{className:"buyer",children:[Object(x.jsx)("div",{children:"Complete seus dados"}),Object(x.jsx)(B.b,{name:"name",placeholder:"Nome completo",type:"text"}),Object(x.jsx)(B.a,{component:"span",name:"name"}),Object(x.jsx)(B.b,{name:"address",placeholder:"Rua, bairro, n\xfamero, complemento, cidade",type:"text"}),Object(x.jsx)(B.a,{component:"span",name:"address"}),Object(x.jsx)(B.b,{name:"cellphone",placeholder:"Celular com DDD",type:"text"}),Object(x.jsx)(B.a,{component:"span",name:"cellphone"}),Object(x.jsx)(B.b,{name:"note",placeholder:"Observa\xe7\xe3o, exemplo: fazer a estampa menor, etc",type:"text"}),Object(x.jsx)(B.a,{component:"span",name:"note"}),s&&Object(x.jsx)(N,{})||Object(x.jsx)("button",{type:"submit",children:"Pagar"})]})})]})})]})}var E=function(){return Object(x.jsx)(s.a,{children:Object(x.jsxs)(r.c,{children:[Object(x.jsx)(r.a,{path:"/alo/",exact:!0,children:Object(x.jsx)(w,{})}),Object(x.jsx)(r.a,{path:"/alo/produto/:id",children:Object(x.jsx)(_,{})}),Object(x.jsx)(r.a,{path:"/alo/checkout/:productId/:merchantId",children:Object(x.jsx)(z,{})}),Object(x.jsx)(r.a,{path:"/alo/checkout-info",children:Object(x.jsx)(T,{})})]})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var J=new URLSearchParams(window.location.search);localStorage.setItem("kindId",J.get("kindId")||"2"),localStorage.setItem("imprimaId",J.get("imprimaId")||""),localStorage.setItem("origin",J.get("origin")||""),o.a.render(Object(x.jsx)(i.a.StrictMode,{children:Object(x.jsx)(E,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},89:function(e,t,c){},90:function(e,t,c){},92:function(e,t,c){},93:function(e,t,c){},94:function(e,t,c){}},[[209,1,2]]]);
//# sourceMappingURL=main.c3f0d7b3.chunk.js.map